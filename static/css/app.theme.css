/* ===================== app.theme.css =====================
Ubicación sugerida: /backend/static/css/app.theme.css  (o /static/css/app.theme.css)
En base.html:
<link rel="stylesheet" href="{{ url_for('static', path='css/app.theme.css') }}">
========================================================= */

/* ---------- Design tokens (Brand Suizo) ---------- */
:root{
  /* Marca */
  --brand-500:#04436a; /* Azul oscuro (principal) */
  --brand-600:#033858; /* hover/active */
  --brand-700:#022b44; /* pressed */
  --brand-300:#5274ce; /* Azul alternativo (acentos/links) */
  --brand-100:#e7ecfa; /* tinte suave para fondos sutiles */
  --brand-white:#ffffff;

  /* Neutrales afinados a fondo cálido */
  --bg:#eeede8;              /* Fondo amarillo pálido (APP) */
  --surface:#ffffff;          /* Cards/sheets */
  --muted:#f2f1ed;            /* Paneles/inputs */
  --text:#0f2a3a;             /* Texto principal */
  --text-2:#4a5a6a;           /* Secundario */
  --border:#d9ddd8;           /* Bordes suaves */

  /* Accesibilidad inputs/placeholder (NUEVO) */
  --input-bg:#ffffff;
  --input-text:var(--text);
  --input-placeholder:var(--text-2);
  --input-border:var(--border);
  --input-border-focus:#5274ce;
  --input-shadow-focus:0 0 0 .25rem rgba(82,116,206,.25);

  /* Chips/Badges (NUEVO) */
  --chip-bg: #e7ecfa;
  --chip-text: #233a80;

  /* Iconos (NUEVO) */
  --icon: #5b6b7a;           /* usa currentColor en SVG */

  /* Pasteles (opcional) */
  --mint-200:#e4f5ee; --sky-200:#e7ecfa; --peach-200:#fff2e8; --violet-200:#f2f0ff;

  /* Sombras / radios */
  --radius:18px; --radius-lg:22px;
  --shadow-lg: 0 16px 40px rgba(8,30,61,.12);
  --shadow-md: 0 10px 24px rgba(8,30,61,.10);
  --shadow-sm: 0 6px 16px rgba(8,30,61,.08);

  /* Bootstrap overrides */
  --bs-primary: var(--brand-500);
  --bs-secondary: var(--brand-300);
  --bs-body-bg: var(--bg);
  --bs-body-color: var(--text);
  --bs-border-color: var(--border);
  --bs-link-color: var(--brand-300);
  --bs-link-hover-color: #3e5fb3;

  /* Layout helpers */
  --header-h: 76px;
  --container-max: 1240px;

  /* Safe areas (iOS notch) */
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);

  /* Rings (para box-shadow rgba) */
  --ring-color: 82,116,206; /* rgb de #5274ce */
}

/* ---------- Dark theme ---------- */
html[data-theme="dark"]{
  --bg:#0F141A;
  --surface:#151B22;
  --muted:#1B232C;
  --text:#E5ECF3;
  --text-2:#A9B6C6;
  --border:#263140;

  /* elevar brillo de marca en dark para contraste */
  --brand-100:#0E1C2A;
  --bs-link-color:#9cc7ff;
  --bs-link-hover-color:#b9d6ff;

  /* Inputs/placeholder (NUEVO) */
  --input-bg:#151B22;
  --input-text:var(--text);
  --input-placeholder:var(--text-2);
  --input-border:#263140;
  --input-border-focus:#5b76b4;
  --input-shadow-focus:0 0 0 .25rem rgba(90,134,255,.30);

  /* Chips/Badges (NUEVO) */
  --chip-bg:#17223e;
  --chip-text:#c7d3ff;

  /* Iconos (NUEVO) */
  --icon:#a8b3c7;

  --shadow-lg: 0 16px 40px rgba(0,0,0,.45);
  --shadow-md: 0 10px 24px rgba(0,0,0,.40);
  --shadow-sm: 0 6px 16px rgba(0,0,0,.35);
}

/* ---------- Base ---------- */
html,body{height:100%;}
/* ❗ Evita “formato PC” en móviles por overflow horizontal */
html,body{ overflow-x:hidden; }
body{
  background:var(--bg);
  color:var(--text);
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
/* Medios fluidos */
img, video, canvas, iframe{ max-width:100%; height:auto; }

/* Enlaces */
a{ color: var(--bs-link-color); text-decoration: none; }
a:hover{ color: var(--bs-link-hover-color); text-decoration: underline; }

/* ---------- Topbar (sticky) ---------- */
.app-topbar{
  position:fixed; top:0; left:0; right:0; z-index:1030;
  background: var(--surface);
  border-bottom:1px solid var(--border);
  box-shadow: 0 2px 10px rgba(8,30,61,.04);
}
.app-topbar .navbar-brand{font-weight:700; letter-spacing:.2px; color: var(--brand-500); }
.app-topbar .nav-link, .app-topbar .navbar-text{color:var(--text-2);} 
.app-topbar .btn-chat{ border-radius: 999px; padding:.5rem 1rem; font-weight:600; }
/* Variante opcional: topbar con fondo de marca (usar .app-topbar.brand en el HTML si la querés) */
.app-topbar.brand{ background: var(--brand-500); border-bottom-color: transparent; }
.app-topbar.brand .navbar-brand,
.app-topbar.brand .nav-link,
.app-topbar.brand .navbar-text{ color:#ffffffcc; }
.app-topbar.brand .nav-link:hover{ color:#ffffff; }

@media (max-width: 575.98px){
  .app-topbar .navbar-text{ display:none; } /* opcional */
}

/* ---------- Layout ---------- */
.app-main{ padding-top: var(--header-h); }
.container-xxl{ max-width: var(--container-max); }
/* En móviles, que el contenedor use todo el ancho con padding lateral */
@media (max-width: 575.98px){
  .container-xxl{ max-width:100% !important; padding-left:12px; padding-right:12px; }
}

/* ---------- Cards ---------- */
.card-clean{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow-sm);
}
.card-clean .card-header{ background:linear-gradient(180deg, rgba(4,67,106,.06), rgba(4,67,106,0)); border-bottom:1px solid var(--border); }
.card-clean .card-body{ padding:1rem 1.25rem; }

/* ---------- Segmented control ---------- */
.segmented{ display:inline-flex; background:var(--muted); border-radius:999px; padding:4px; gap:4px; border:1px solid var(--border); }
.segmented .btn{ border-radius:999px; font-weight:600; }
.segmented .btn.active{ background:var(--surface); box-shadow:var(--shadow-sm); }

/* ---------- Menú offcanvas (Bootstrap) ---------- */
.offcanvas-start{ border-right:1px solid var(--border); background:var(--surface); }
.app-menu a{ color:var(--text-2); border-radius:12px; }
.app-menu a.active,.app-menu a:hover{ background:var(--muted); color:var(--text); }

@media (max-width: 575.98px){
  .offcanvas-start{ width: 88vw; max-width: 420px; }
}
@media (min-width: 576px) and (max-width: 991.98px){
  .offcanvas-start{ width: 360px; }
}

/* ---------- Inputs ---------- */
.form-control, .form-select{
  border-radius:12px;
  border-color:var(--input-border);
  background:var(--input-bg);
  color:var(--input-text);
}
.form-control::placeholder, .form-select::placeholder{
  color:var(--input-placeholder); opacity:1;
}
.form-control:focus, .form-select:focus{
  box-shadow:var(--input-shadow-focus);
  border-color:var(--input-border-focus);
}

/* Tamaño compacto útil en móvil */
.input-compact .form-control,
.input-compact .form-select{ padding:.45rem .6rem; font-size:.95rem; }

/* ---------- Botones (toman de los tokens Bootstrap) ---------- */
.btn-primary{
  --bs-btn-bg: var(--brand-500);
  --bs-btn-border-color: var(--brand-500);
  --bs-btn-hover-bg: var(--brand-600);
  --bs-btn-hover-border-color: var(--brand-600);
  --bs-btn-active-bg: var(--brand-700);
  --bs-btn-active-border-color: var(--brand-700);
  --bs-btn-color: #ffffff;
}
.btn-secondary{
  --bs-btn-bg: var(--brand-300);
  --bs-btn-border-color: var(--brand-300);
  --bs-btn-hover-bg: #3e5fb3;
  --bs-btn-hover-border-color: #3e5fb3;
  --bs-btn-color: #ffffff;
}
.btn-outline-primary{ color: var(--brand-500); border-color: var(--brand-500); }
.btn-outline-primary:hover{ color:#fff; background: var(--brand-500); border-color: var(--brand-500); }
.btn-outline-secondary{ color: var(--brand-300); border-color: var(--brand-300); }
.btn-outline-secondary:hover{ color:#fff; background: var(--brand-300); border-color: var(--brand-300); }

/* ---------- Badges / Chips (NUEVO) ---------- */
.badge, .chip{
  background:var(--chip-bg);
  color:var(--chip-text);
  border:1px solid var(--border);
  border-radius:999px;
  font-weight:600;
}

/* ---------- Iconos (NUEVO) ---------- */
.icon, .icon-btn svg{ color:var(--icon); fill:currentColor; stroke:currentColor; }
.icon-btn{ background:transparent; border:1px solid var(--border); border-radius:10px; }
.icon-btn:hover{ background:var(--muted); }

/* ---------- Tablas responsivas ---------- */
.table-wrap{ width:100%; overflow-x:auto; -webkit-overflow-scrolling: touch; }
.table-wrap > .table{ width:100%; white-space:nowrap; margin-bottom:0; }
.table thead{ background:var(--muted); }
html[data-theme="dark"] .table thead{ background:#0f172a; }

/* ---------- AI widget ---------- */
.ai-widget{
  position:fixed; right:24px; bottom:88px;
  width:360px; max-width:86vw; height:520px;
  background:var(--surface); border:1px solid var(--border);
  border-radius:18px; box-shadow:var(--shadow-lg); overflow:hidden;
  transform:translateY(16px); opacity:0; pointer-events:none;
  transition: all .2s cubic-bezier(0.22,1,0.36,1);
  z-index: 1040;
}
.ai-widget.open{ transform:translateY(0); opacity:1; pointer-events:auto; }
.ai-widget .ai-header{ display:flex; align-items:center; justify-content:space-between; padding:.5rem .75rem; border-bottom:1px solid var(--border); }
.ai-widget .ai-body{ height:100%; background:var(--bg); }

@media (max-width: 575.98px){
  .ai-widget{ right:12px; left:12px; width:auto; height: 70vh; bottom: 16px; }
}

/* ---------- FAB ---------- */
.fab{
  position:fixed; right:24px; bottom:24px; z-index:1030;
  border-radius:999px; padding:.875rem 1rem; font-weight:700;
  box-shadow:var(--shadow-lg);
}
@media (max-width: 575.98px){
  .fab{ right:16px; bottom:16px; }
}

/* ---------- FullCalendar overrides ---------- */
.fc .fc-toolbar-title{ font-size:1.4rem; font-weight:700; color:var(--text); }
.fc .fc-daygrid-day-number{ font-weight:600; color:var(--text-2); }
.fc .fc-daygrid-day-frame{ background:var(--surface); }
.fc-theme-standard .fc-scrollgrid{ border:1px solid var(--border); border-radius:16px; overflow:hidden; }
.fc .fc-col-header-cell{ background:var(--muted); }
.fc .fc-button{ border-radius:999px; border-color:var(--border); background:var(--surface); color:var(--text); }
.fc .fc-button-primary:not(:disabled).fc-button-active{ background:var(--brand-500); border-color:var(--brand-500); }

/* ---------- Utilities ---------- */
.hero-title{
  font-size:clamp(1.6rem, 1.2rem + 1.2vw, 2rem);
  font-weight:800; color:var(--brand-700);
}
.subtle{ color:var(--text-2); }
.help-text{ color:var(--text-2); font-size:.925rem; } /* NUEVO */
.shadow-hover{ transition: box-shadow .18s cubic-bezier(0.22,1,0.36,1), transform .18s; }
.shadow-hover:hover{ box-shadow:var(--shadow-md); transform: translateY(-2px); }

/* Utilidades de marca */
.text-brand{ color: var(--brand-500) !important; }
.text-brand-alt{ color: var(--brand-300) !important; }
.bg-brand{ background: var(--brand-500) !important; color:#fff !important; }
.bg-brand-alt{ background: var(--brand-300) !important; color:#fff !important; }
.bg-brand-soft{ background: rgba(4,67,106,.06) !important; }
.border-brand{ border-color: var(--brand-500) !important; }

/* ---------- Responsive helpers (mobile-first) ---------- */
/* Grillas adaptables para tus vistas (analisis, admin, etc.) */
.stack{ display:grid; gap: .75rem; } /* 1 columna por defecto */
@media (min-width: 768px){
  .cols-md-2{ display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
}
@media (min-width: 992px){
  .cols-lg-3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:1rem; }
  .split{ display:grid; grid-template-columns: 1.2fr .8fr; gap:1rem; } /* Ej: resultados | chat */
}

/* Zonas arrastrar/soltar */
.dropzone{
  border: 2px dashed var(--border); background: var(--muted);
  padding: 1rem; border-radius: var(--radius); text-align:center;
}

/* Alturas útiles para paneles con scroll */
.h-pane-50{ height: 50vh; overflow:auto; }
.h-pane-55{ height: 55vh; overflow:auto; }
.h-pane-60{ height: 60vh; overflow:auto; }
/* Altura real en móviles (evita saltos por barra navegador) */
.h-100dvh{ height: 100dvh; }

/* ---------- Sticky helpers ---------- */
.sticky-topbar{ position: sticky; top: 0; z-index: 10; background: var(--surface); border-bottom: 1px solid var(--border); }
.sticky-footer{ position: sticky; bottom:  0; z-index: 5; background: var(--surface); border-top: 1px solid var(--border); }

/* ---------- MOBILE FIXES EXTRA ---------- */
/* Fuerza apilado si algún CSS externo impone anchos fijos */
@media (max-width: 575.98px){
  .row > [class*="col-"]{
    flex: 0 0 100% !important;
    max-width: 100% !important;
  }
  /* Botones/pills compactos */
  .btn, .btn-chat{ padding:.5rem .9rem; }
  /* Evita que cualquier componente “crezca” más que el viewport */
  .card, .card-clean, .brand, .pill, .icon-btn{ max-width:100%; }
}
/* Neutraliza min-width fijos no deseados */
[class*="container"], [class*="Container"]{ min-width: 0; }

/* ---------- Reduced motion ---------- */
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}

/* =========================================================
   ===== FIX DE CONTRASTE PARA EL CHAT INTERNO (/chat) =====
   - Algunos textos aparecían en blanco/traslúcido.
   - Forzamos color legible en listados, mensajes e inputs.
   - Scoping por ruta: NO afecta otras vistas.
   ========================================================= */
body[data-route^="/chat"] .text-white,
body[data-route^="/chat"] .text-light{
  color: var(--text) !important;
  /* evita textos blancos heredados de utilidades Bootstrap */
}

/* Lista de conversaciones y panel principal */
body[data-route^="/chat"] .chat-header,
body[data-route^="/chat"] .chat-header * ,
body[data-route^="/chat"] .chat-body,
body[data-route^="/chat"] .chat-body * ,
body[data-route^="/chat"] .conversations,
body[data-route^="/chat"] .conversations * ,
body[data-route^="/chat"] .empty-state,
body[data-route^="/chat"] .empty-state * {
  color: var(--text);
}

/* Burbujas de mensajes (propios y de la IA/otro) */
body[data-route^="/chat"] .msg,
body[data-route^="/chat"] .msg *{
  color: var(--text);
}

/* Composer y buscadores (texto + placeholder) */
body[data-route^="/chat"] input,
body[data-route^="/chat"] textarea,
body[data-route^="/chat"] .form-control{
  color: var(--input-text);
  background: var(--input-bg);
  border-color: var(--input-border);
}
body[data-route^="/chat"] input::placeholder,
body[data-route^="/chat"] textarea::placeholder,
body[data-route^="/chat"] .form-control::placeholder{
  color: var(--input-placeholder);
  opacity: 1;
}
/* Compatibilidad extra (algunos navegadores antiguos) */
body[data-route^="/chat"] input::-webkit-input-placeholder,
body[data-route^="/chat"] textarea::-webkit-input-placeholder{ color: var(--input-placeholder); }
body[data-route^="/chat"] input:-ms-input-placeholder,
body[data-route^="/chat"] textarea:-ms-input-placeholder{ color: var(--input-placeholder); }

/* ===== Fix extra: correo/subtítulo en lista de conversaciones ===== */
body[data-route^="/chat"] .conversations small,
body[data-route^="/chat"] .conversations .small,
body[data-route^="/chat"] .conversations .text-muted,
body[data-route^="/chat"] .conversations .text-white-50,
body[data-route^="/chat"] .conversations .text-white-75,
body[data-route^="/chat"] .conversations .opacity-50,
body[data-route^="/chat"] .conversations .opacity-75,
body[data-route^="/chat"] .conversations [class*="text-white"],
body[data-route^="/chat"] .conversations [class*="opacity-"]{
  color: var(--text-2) !important; /* legible en claro y oscuro */
  opacity: 1 !important;           /* elimina transparencia */
}

/* =========================================================
   PARCHE ADITIVO: desbordes + “hover-lift” SOLO en contenido
   - Evita que íconos/textos se salgan de tarjetas
   - Neutraliza el levantado en hover que generaba el problema
   - No afecta sidebar/topbar/overlays
   ========================================================= */
.content .card,
.content .card-clean,
.content .cardx,
.content .section-card,
.content .card > .card-body,
.content .card-clean > .card-body,
.content .cardx > .card-body{
  overflow: hidden;                 /* recorte dentro del borde */
  border-radius: inherit;           /* respeta el radio del contenedor */
}

/* Anula “levantar” localmente (mantiene la sombra mejorada) */
.content .shadow-hover:hover,
.content .card:hover,
.content .card-clean:hover,
.content .cardx:hover,
.content .section-card:hover,
.content .list-group-item:hover{
  transform: none !important;
  translate: none !important;
  box-shadow: var(--shadow-md);
}

/* Flex: deja encoger contenido para que no empuje y desborde */
.content .row > [class^="col"],
.content .row > [class*=" col"],
.content .d-flex > *,
.content .input-group,
.content .form-group,
.content .form-control,
.content .form-select,
.content .btn,
.content .badge,
.content .pill{
  min-width: 0;
  max-width: 100%;
}

/* Celdas de Acciones (admin/auditoría) envuelven correctamente */
td.acciones, .acciones, .acciones-cell{
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
}

/* Tablas dentro de tarjetas: que recorten en bordes redondeados */
.content .card .table-responsive,
.content .card-clean .table-responsive,
.content .cardx .table-responsive{
  overflow: hidden;
  border-radius: inherit;
}

/* FullCalendar: sin “lift” en botones */
.content .fc .fc-button:hover{
  transform: none !important;
  translate: none !important;
}

/* Badges/chips no expanden celdas */
.content .badge{
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  white-space: nowrap;
  max-width: 100%;
}
