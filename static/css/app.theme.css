/* ===================== app.theme.css =====================
Place in: /backend/static/css/app.theme.css  (or /static/app.theme.css)
Link it in base.html with:
<link rel="stylesheet" href="{{ url_for('static', path='css/app.theme.css') }}">
========================================================= */

/* ---------- Design tokens ---------- */
:root{
  /* Brand */
  --brand-700:#03314B; /* deep */
  --brand-600:#044369; /* Suizo */
  --brand-500:#0D6EFD; /* accent */
  --brand-300:#5AA6FF;
  --brand-100:#E8F2FF;

  /* Neutrals */
  --bg:#F6F8FB;               /* app background */
  --surface:#FFFFFF;          /* cards */
  --muted:#EEF2F7;            /* panels / inputs */
  --text:#1C2430;             /* primary text */
  --text-2:#5E6B7A;           /* secondary */
  --border:#E5EBF2;           /* soft borders */

  /* Feedback pastels */
  --mint-200:#DFF5EA; --sky-200:#E8F2FF; --peach-200:#FFEFE6; --violet-200:#F1EDFF;

  /* Radii & shadow */
  --radius:18px; --radius-lg:22px;
  --shadow-lg: 0 16px 40px rgba(8,30,61,.12);
  --shadow-md: 0 10px 24px rgba(8,30,61,.10);
  --shadow-sm: 0 6px 16px rgba(8,30,61,.08);

  /* Bootstrap overrides */
  --bs-primary: var(--brand-500);
  --bs-body-bg: var(--bg);
  --bs-body-color: var(--text);

  /* Layout helpers */
  --header-h: 76px;
  --container-max: 1240px;

  /* Safe areas (iOS notch) */
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
}

/* Dark theme */
html[data-theme="dark"]{
  --bg:#0F141A;
  --surface:#151B22;
  --muted:#1B232C;
  --text:#E5ECF3;
  --text-2:#A9B6C6;
  --border:#263140;
  --brand-100:#0E1C2A;
  --shadow-lg: 0 16px 40px rgba(0,0,0,.45);
  --shadow-md: 0 10px 24px rgba(0,0,0,.40);
  --shadow-sm: 0 6px 16px rgba(0,0,0,.35);
}

/* ---------- Base ---------- */
html,body{height:100%;}
/* ❗ Evita “formato PC” en móviles por overflow horizontal */
html,body{ overflow-x:hidden; }
body{
  background:var(--bg);
  color:var(--text);
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
/* Medios fluidos */
img, video, canvas, iframe{ max-width:100%; height:auto; }

/* ---------- Topbar (sticky) ---------- */
.app-topbar{
  position:fixed; top:0; left:0; right:0; z-index:1030;
  background: var(--surface);
  border-bottom:1px solid var(--border);
  box-shadow: 0 2px 10px rgba(8,30,61,.04);
}
.app-topbar .navbar-brand{font-weight:700; letter-spacing:.2px;}
.app-topbar .nav-link, .app-topbar .navbar-text{color:var(--text-2);} 
.app-topbar .btn-chat{ border-radius: 999px; padding:.5rem 1rem; font-weight:600;}
/* Wrap en acciones para que no “salten” en XS */
@media (max-width: 575.98px){
  .app-topbar .navbar-text{ display:none; } /* opcional */
}

/* ---------- Layout ---------- */
.app-main{ padding-top: var(--header-h); }
.container-xxl{ max-width: var(--container-max); }
/* En móviles, que el contenedor use todo el ancho con padding lateral */
@media (max-width: 575.98px){
  .container-xxl{ max-width:100% !important; padding-left:12px; padding-right:12px; }
}

/* ---------- Cards ---------- */
.card-clean{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow-sm);
}
.card-clean .card-header{ background:transparent; border-bottom:1px solid var(--border); }
.card-clean .card-body{ padding:1rem 1.25rem; }

/* ---------- Segmented control ---------- */
.segmented{ display:inline-flex; background:var(--muted); border-radius:999px; padding:4px; gap:4px; border:1px solid var(--border); }
.segmented .btn{ border-radius:999px; font-weight:600; }
.segmented .btn.active{ background:var(--surface); box-shadow:var(--shadow-sm); }

/* ---------- Menú offcanvas (Bootstrap) ---------- */
.offcanvas-start{ border-right:1px solid var(--border); background:var(--surface); }
.app-menu a{ color:var(--text-2); border-radius:12px; }
.app-menu a.active,.app-menu a:hover{ background:var(--muted); color:var(--text); }

@media (max-width: 575.98px){
  .offcanvas-start{ width: 88vw; max-width: 420px; }
}
@media (min-width: 576px) and (max-width: 991.98px){
  .offcanvas-start{ width: 360px; }
}

/* ---------- Inputs ---------- */
.form-control, .form-select{
  border-radius:12px; border-color:var(--border);
  background:var(--surface); color:var(--text);
}
.form-control:focus, .form-select:focus{
  box-shadow:0 0 0 .25rem rgba(13,110,253,.15); border-color:var(--brand-300);
}

/* Tamaño compacto útil en móvil */
.input-compact .form-control,
.input-compact .form-select{ padding:.45rem .6rem; font-size:.95rem; }

/* ---------- Tablas responsivas ---------- */
.table-wrap{ width:100%; overflow-x:auto; -webkit-overflow-scrolling: touch; }
.table-wrap > .table{ width:100%; white-space:nowrap; margin-bottom:0; }
.table thead{ background:var(--muted); }
html[data-theme="dark"] .table thead{ background:#0f172a; }

/* ---------- AI widget ---------- */
.ai-widget{
  position:fixed; right:24px; bottom:88px;
  width:360px; max-width:86vw; height:520px;
  background:var(--surface); border:1px solid var(--border);
  border-radius:18px; box-shadow:var(--shadow-lg); overflow:hidden;
  transform:translateY(16px); opacity:0; pointer-events:none;
  transition: all .2s cubic-bezier(0.22,1,0.36,1);
  z-index: 1040;
}
.ai-widget.open{ transform:translateY(0); opacity:1; pointer-events:auto; }
.ai-widget .ai-header{ display:flex; align-items:center; justify-content:space-between; padding:.5rem .75rem; border-bottom:1px solid var(--border); }
.ai-widget .ai-body{ height:100%; background:var(--bg); }

@media (max-width: 575.98px){
  .ai-widget{ right:12px; left:12px; width:auto; height: 70vh; bottom: 16px; }
}

/* ---------- FAB ---------- */
.fab{
  position:fixed; right:24px; bottom:24px; z-index:1030;
  border-radius:999px; padding:.875rem 1rem; font-weight:700;
  box-shadow:var(--shadow-lg);
}
@media (max-width: 575.98px){
  .fab{ right:16px; bottom:16px; }
}

/* ---------- FullCalendar overrides ---------- */
.fc .fc-toolbar-title{ font-size:1.4rem; font-weight:700; color:var(--text); }
.fc .fc-daygrid-day-number{ font-weight:600; color:var(--text-2); }
.fc .fc-daygrid-day-frame{ background:var(--surface); }
.fc-theme-standard .fc-scrollgrid{ border:1px solid var(--border); border-radius:16px; overflow:hidden; }
.fc .fc-col-header-cell{ background:var(--muted); }
.fc .fc-button{ border-radius:999px; border-color:var(--border); background:var(--surface); color:var(--text); }
.fc .fc-button-primary:not(:disabled).fc-button-active{ background:var(--brand-500); border-color:var(--brand-500); }

/* ---------- Utilities ---------- */
.hero-title{
  font-size:clamp(1.6rem, 1.2rem + 1.2vw, 2rem);
  font-weight:800; color:var(--brand-700);
}
.subtle{ color:var(--text-2); }
.shadow-hover{ transition: box-shadow .18s cubic-bezier(0.22,1,0.36,1), transform .18s; }
.shadow-hover:hover{ box-shadow:var(--shadow-md); transform: translateY(-2px); }

/* ---------- Responsive helpers (mobile-first) ---------- */
/* Grillas adaptables para tus vistas (analisis, admin, etc.) */
.stack{ display:grid; gap: .75rem; } /* 1 columna por defecto */
@media (min-width: 768px){
  .cols-md-2{ display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
}
@media (min-width: 992px){
  .cols-lg-3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:1rem; }
  .split{ display:grid; grid-template-columns: 1.2fr .8fr; gap:1rem; } /* Ej: resultados | chat */
}

/* Zonas arrastrar/soltar */
.dropzone{
  border: 2px dashed var(--border); background: var(--muted);
  padding: 1rem; border-radius: var(--radius); text-align:center;
}

/* Alturas útiles para paneles con scroll */
.h-pane-50{ height: 50vh; overflow:auto; }
.h-pane-55{ height: 55vh; overflow:auto; }
.h-pane-60{ height: 60vh; overflow:auto; }
/* Altura real en móviles (evita saltos por barra navegador) */
.h-100dvh{ height: 100dvh; }

/* ---------- Sticky helpers ---------- */
.sticky-topbar{ position: sticky; top: 0; z-index: 10; background: var(--surface); border-bottom: 1px solid var(--border); }
.sticky-footer{ position: sticky; bottom: 0; z-index: 5; background: var(--surface); border-top: 1px solid var(--border); }

/* ---------- MOBILE FIXES EXTRA ---------- */
/* Fuerza apilado si algún CSS externo impone anchos fijos */
@media (max-width: 575.98px){
  .row > [class*="col-"]{
    flex: 0 0 100% !important;
    max-width: 100% !important;
  }
  /* Botones/pills compactos */
  .btn, .btn-chat{ padding:.5rem .9rem; }
  /* Evita que cualquier componente “crezca” más que el viewport */
  .card, .card-clean, .brand, .pill, .icon-btn{ max-width:100%; }
}
/* Cualquier contenedor inesperado con min-width fijo quedará neutralizado */
[class*="container"], [class*="Container"]{ min-width: 0; }

/* ---------- Reduced motion ---------- */
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}
